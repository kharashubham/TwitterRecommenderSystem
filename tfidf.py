import math
from textblob import TextBlob as tb

def tf(word, blob):
    return blob.words.count(word) / len(blob.words)


def n_containing(word, bloblist):
    return sum(1 for blob in bloblist if word in blob)


def idf(word, bloblist):
    return math.log(len(bloblist) / (1 + n_containing(word, bloblist)))


def tfidf(word, blob, bloblist):
    return tf(word, blob) * idf(word, bloblist)


def tfidf_rank(data,i,user):
    bloblist = []
    user_list = {}
    for x in range(1,i+1):
        stre = str(x)
        f = open("tw_db/t" + stre + ".txt", "r")
        text = ""
        for line in f:
            text = line + " " + text
        bloblist.append(tb(text))
    for i, blob in enumerate(bloblist):
        for tweet in data[i]:
            scores = {word: tfidf(word, blob, bloblist) for word in tweet if word != ""}
        sorted_words = sorted(scores.items(), key=lambda x: x[1], reverse=True)
        user_list[user[i]] = sorted_words
    return user_list

#
# ky = [[['everyth', 'transform', 'time', '✨'], ['guess', 'time', 'tracksuit'], ['beatsbydr', 'bravo', 'time'], ['HAPPi', 'BIHDAY', 'PEPPERONI'], [' a', 'lenadunham', 'woman', 'life', 'freakin', 'pleasur'], ['MAKE', 'LYRIC', 'GREAT', 'AGAIN❗️cc', 'Max', 'Martin', 'amp', 'Shellback'], [' a', 'AnaGastey', 'Nasti', 'Woman'], ['poll', 'Nov', 'Queen'], ['Ok', 'studio'], ['parti', ' a', 'chelseahandl', ' a', 'sallykohn', ' a', 'SarahKSilverman', ' a', 'BetteMidl', ' a', 'shannonwoodward', ' a', 'getglucki'], ['peopl'], ['HillaryClinton', 'Nobodi', 'women', 'Trump'], [], ['woman', 'Trump', 'Deba…'], ['Someon', 'time', 'jaw', 'Crazi', 'debat'], ['Scott_Myrick', 'HillaryClinton'], [' a', 'katyperri', 'seat', 'tabl', ' a', 'HillaryClinton'], ['seat', 'tabl', ' a', 'HillaryClinton'], ['HillaryClinton', 'Scorpio', 'season'], ['scottsimonsWVLA', 'Lot', 'luck', 'acknowledg', 'loss', 'debatenight'], [' a', 'sallykohn', 'person', 'presid', 'histori', 'HillaryClinton', 'BernieSand'], [], ['debatenight…'], [' Instant Messag', 'sleep', 'watch'], [' a', 'cher', 'tub'], [' a', 'bijanstephen', 'trump', 'tag', 'hillari', 'chess'], ['screenshot'], [], ['Cab', 'Malbec'], ['shannonwoodward', 'guy', 'democraci', 'America'], ['person', 'respect', 'women', 'Donald', 'Trump', 'Bill', 'Cosbi', 'debat'], ['CELEBR', 'OUR', 'DIVERS', 'AND', 'LIFT', 'PEOPL', 'UP', ' a', 'HillaryClinton'], [' a', 'JackGarratt', 'term', 'memori', 'word', 'Hillari', 'minut…'], ['ameliashowalt'], ['TIMELIN', '⤵️', ' a', 'HillaryClinton'], ['shannonwoodward', 'job', 'Senat', 'Secretari', 'State'], ['Alway'], [' a', 'rejectedjok', 'tweet'], ['ad'], [], ['drop'], ['THE', 'PUPPET', 'MEME', 'DEBAT', 'IM', 'SCREAMKNG'], ['Notori', 'B.I.G.L.i'], ['Si', 'señorita'], ['sallykohn', 'badhombr'], ['life', 'Lol'], [' a', 'sallykohn', 'women', 'right', 'health', 'care', 'decis', 'HillaryClinton'], [], ['THANK', 'ImWithH'], ['debat…'], ['Tweet', 'night'], ['WE', 'ARE', 'GET', 'INTO', 'REAL', 'ISSU', 'EVEN', 'UNCOMFO', 'ONES❗️', 'debat'], ['SarahKSilverman', 'constitut', 'way', ' dude', 'Tommi', 'Jefferson', 'wi…'], ['SarahKSilverman', 'man', 'babi'], ['jonlovett', ' true', 'Babi', 'back'], ['jonlovett', 'Hillari', 'Suprem', 'Court'], ['Trump', 'Suprem', 'Court'], ['rule', 'boss', 'debat'], ['MY', 'WHITE', 'ANGEL', ' a', 'HillaryClinton'], [' a', 'rejectedjok', 'parti'], ['chelseahandl', 'hang'], ['YOU', 'THI', ' a', 'HillaryClinton', 'DEBAT'], ['therapi', 'medit', 'THE', 'DEBAT'], [], ['Chanc', 'Rapper', 'Frank', 'Ocean', 'parent', 'White', 'Hous', 'State', 'Dinner'], ['S/O', 'A', 'amp', 'R', ' a', 'getglucki', 'quot', 'audienc', 'art'], ['yungskeet'], ['HillaryClinton', '“Two', 'word', 'Madam', 'Presid', ' a', 'VogueMagazin', 'endors'], ['Felt', 'fairi', 'godmoth', 'night', ' a', 'marchesafashion', ' a', 'childrensla', '❤️'], ['part', 'night', '❤️'], ['side', 'grave', 'steel', 'drum', 'choker'], ['petal', 'club'], ['lot', 'women', 'HERstori', 'elect', 'cycl', 'ballot', 'Nov…'], ['girl', 'live', 'world', 'ALL', 'yo…'], [' a', 'COVERGIRL', 'shoot', 'pleasur', 'very…'], ['brain', 'scienc', 'dissect', 'util', ' a', 'Sia', 'ILYSM', '❤️'], ['debat', 'OCT', 'WAY', 'TO', 'COVER', 'MORE', 'ISSU', 'debat'], ['iamkidpresid'], ['Twitter', 'world', 'Hillari', 'L', 'room', 'typo'], ['THI', '⤵️'], ['debat'], ['BetteMidl', 'bottl'], ['Make', 'karlbeck', 'TT', '❤️'], ['KarlBeck'], ['iamrashidajon', 'Karl', 'Becker', 'FTW'], ['HEA', 'GOE', 'ON'], [' a', 'jessesaintjohn', 'Sweet', 'debat'], ['DROPTHEMICHRC'], [' a', 'RonanFarrow', 'number'], ['yungskeet', 'unproud'], [' a', 'TVMcGee', 'time', 'liiif', 'debat'], ['jonlovett', 'Donald', 'Trump', 'dream', 'class'], ['COME', 'ON', 'WE', 'DONT', 'HAVE', 'TIME', 'TO', 'MISS', 'THI'], [' a', 'RonanFarrow', 'GIF', ' know'], [' a', 'birbig', '-Donald', 'Trump', ' repli', 'Syria', 'polici', 'RUN', 'MATE', 'debat'], [' a', 'RonanFarrow', 'meme'], [' a', 'RonanFarrow', 'Trump', 'Penc'], ['Trump', 'term', 'paper'], [], ['Sourc'], [], [], ['Everybodi'], ['realDonaldTrump', 'Putin', 'Miss', 'Univers', 'Pageant', 'Novemb', 'Moscow', 'bes…'], ['SarahKSilverman', 'Donald', 'time', 'debat'], ['mic', 'tonight', 'PLEAS', 'DROP', 'THE', 'MIC', 'TONIGHT', 'HILL', '⤵️', ' a', 'HillaryClinton', 'DROPTHEMICHRC', 'debat'], ['YA'], [' a', 'fuck', 'post', 'offic', 'millenni', 'debat'], ['sallykohn', 'peopl', 'America', 'man', 'countri'], [' a', 'sallykohn', 'Yaaaaaasssssssssss'], ['*teeth'], ['IT', 'TO', 'SMILE', 'WITH', 'YOUR', 'MOUTH', 'YOUGOTTHI'], ['AT', 'THE', 'TV', 'RIGHT', 'NOW', 'debat']], [['❤️'], ['Thank', 'ATT', 'fun'], ['ATT', 'Welcom', 'team', ' a', 'taylorswift13'], ['GraceVanderWa', 'Word', 'this..', 'thank', 'taylorswift13'], ['today', 'famili', 'think', 'famili', 'someon', 'year', 'NeverForget911'], [' a', 'AfricanPark', 'Thank', 'TaylorSwift13', 'donat', 'AfricanPark', 'WorldElephantDay'], ['congratul', 'Simon', 'Ali', 'Lauri', 'Gabbi', 'Madison', 'YOU', 'IT', 'GIRL'], ['moment', 'Kany', 'West', 'phone', 'call', 'Kim', 'Internet'], ['heart'], ['peopl', 'world', 'today', '❤️'], ['Danc', 'one', 'watch', ' a', 'AppleMus', ' a', 'thedark'], [], ['DietCok', 'Congratul', ' a', 'taylorswift13', 'BMI', 'Taylor', 'Swift', 'Award', 'thing', 'style', '…'], ['time', 'night'], ['night', 'BMI', 'award', 'Taylor', 'Swift', 'Award'], ['WOAH', 'thank', 'voguemagazin', 'cover', 'Theo', 'Wenner', 'photo', 'Met', 'Gala', 'night', '✨'], ['May', 'cover', 'star', ' a', 'taylorswift13', 'tour', 'Beverli', 'Hill', 'home', 'answer', 'http…'], [' a', 'AppleMus', ' a', 'JimmyEatWorld'], [], ['BLEACHELLA'], ['Come', 'parti'], [], ['Thank', 'photo', 'vibessss', ' a', 'mertalasmarcu', 'voguemagazin'], ['Thank', 'jasongay', 'BritMaack', 'wed', 'Vogu', 'cover', 'stori'], ['voguemagazin', 'world’', 'pop', 'star', 'downtim'], ['Thank', 'voguemagazin'], [' a', 'JosephKahn', 'Thank', 'hardwar', 'home', 'decor', ' a', '…'], ['peopl', 'life'], [], ['NewRomant'], [], ['kelly_clarkson', 'Oh', 'gosh', ' a', 'right', 'treadmil', 'thing', 'e…'], ['run', 'memori', 'amp', 'iHeartAward'], ['selenagomez', 'OG'], [' a', 'friend', 'Taylor', 'iHeartAward'], ['iHeartAward'], ['troyesivan', ' a', 'RubyRos'], ['event', 'TAYLORvsTREADMIL'], [' a', 'Drake'], [], [], ['austinswift7', 'year', 'twenti', 'heads-up', "might've…"], ['GROUND', 'YOURSELF'], [' a', 'austinswift7'], ['loss'], [' a', 'austinswift7'], ['Easter', 'Egg', 'Battl'], [' a', 'austinswift7'], ['twitter', 'Thank', 'taylorswift13', 'love', 'stage', 'day', 'LoveTwitt'], [], ['Dog', ' though'], ['HAPPi', 'BIHDAY', 'AUSTIN'], ['Thank', 'year', 'LOL'], [' a', 'austinswift7'], ['RWitherspoon', 'Happi', 'InternationalWomensDay', 'inspir', 'courtesi', ' a', 'taylorswift13', 'IWD2016', ' a', 'FOXADHD', '…'], ['today'], ['Pledg', 'Pariti'], [], ['HappyInternationalWomensDay'], ['goal', 'primetim', 'drama', 'seri', 'Famili', 'Secret'], ['Romant'], ['BindiIrwin', 'So', 'peopl', ' a', 'taylorswift13', 'world', 'share', 'posit', 'light', 'remind', 's…'], [' a', 'RubyRos', 'Congratul', ' a', 'taylorswift13', 'queen', 'point', 'spe…'], ['alexmorgan13', 'Preach', ' a', 'taylorswift13', 'women', 'platform', 'girl', 'women', 'po…'], ['AbbyWambach', 'Amen', ' a', 'A-effing-men', 'mygoshwhatanacceptancespeech'], ['moment'], [' a', 'jackantonoff'], ['GRAMMi'], ['jessetyl', 'inner', 'today', ' a', 'TheGRAMMi', 'speech', 'anyon'], ['night', '⭐️'], ['High-✋', 'taylorswift13', 'win', 'night', 'Grammi', 'ass', 'speech', 'girl'], ['RWitherspoon', ' a', 'Love', 'word', 'women', 'stori', 'amp', 'song'], ['Mariska', 'Congrat', ' a', 'taylorswift13', 'BadBlood', 'win', 'MadLov', 'VideoOfTheYear', 'BandaidsDontFixBulletHol', 'Grammi'], ['ChrisStapleton'], ['TheGRAMMi', ' a', 'YE'], ['TheGRAMMi', 'Congratul', 'EdSheeran', 'GRAMMi', 'win', 'GRAMMYL', 'GRAMMi', '…'], ['Bad', 'Blood', 'Grammi', 'Best', 'Music', 'Video'], [' a', 'selenagomez'], ['TheGRAMMi', 'Congrat', 'Best', 'Music', 'Video', ' a', 'taylorswift13', 'ft.', ' a', 'kendricklamar', 'Blood', 'GRAMMi'], [' a', 'imogenheap', 'Head', 'designindaba', 'LHR', 'year', 'taylorswift13', 'luck', ' a', 'TheGRAMMi', 't…'], ['jackantonoff', 'album', 'phone', 'album', 'apart', 'grammi', 'it…'], ['TheGRAMMi', 'call', ' a', 'jackantonoff', 'help', 'award', 'GRAMMYPremier', 'https…'], ['TheGRAMMi'], ['TheGRAMMi', 'Congrat', 'Best', 'Pop', 'Vocal', 'Album', ' a', 'GRAMMi'], [' a', 'TheGRAMMi', 'Today', 'day', 'WitnessGreat', 'GRAMMi', 'tonight', ' a', 'CB', 'ET/5PM', 'PT'], ['make', 'Out', 'Wood', 'video', ' a', 'JosephKahn'], [], [], ['COLDPLAY'], ['MARK', 'RONSON'], ['BRUNO', 'MAR'], ['BEYONCÉ'], ['DANC', 'BATTL'], ['FIX', 'YOU', 'MONTAG'], ['JOYOU', 'FINAL'], ['MY', 'GOD', 'IT', 'WA', 'SO'], [' a', 'TheGRAMMi', ' a', 'taylorswift13', 'GRAMMi', 'stage', 'perform', 'GRAMMi', 'Feb.', 'CB', 'https//t…'], [], [], ['MusCornerNash', 'song', ' a', 'taylorswift13', 'Nashvil', 'songwrit', 'CityWineryNSH', 'https//t.…'], ['MusCornerNash', ' a', 'CityWineryNSH'], ['Magic'], ['Mad'], ['Heaven'], ['Sin'], [], [], ['Say'], [], [], [], [], ['somehow', 'everyth'], [], ['OOTWMusicVideo', ' a', 'VEVO'], ['Christma', 'year', 'Light', 'Coldplay'], [' a', 'austinswift7'], [], [], ['OOTWMusicVideo'], ['EST', 'ABC', ' a', 'NYRE', ' a', 'JosephKahn', ' a', 'RyanSeacrest'], ['NYRE', 'Oh', 'anticip', 'OOTWMusicVideo', 'premier', 'RockinEv', 'TONIGHT', '…'], ['wood'], [], ['OOTWMusicVideo', 'tomorrow', 'night', ' a', 'NYRE', ' a', 'RyanSeacrest'], ['elf', 'phone'], ['Mari', 'dream', 'Thank', 'moment', 'LA', '❤️'], [], ['video', 'Out', 'Wood'], [], [' a', 'NYRE', ' a', 'RyanSeacrest'], ['OOTWMusicVideo'], ['GMA', 'That', 'right', ' a', 'taylorswift13', 'music', 'video', 'debut', 'Out', 'Wood', 'RyanSeacrest', 'NYRE', '…'], ['camilacabello97', ' a', 'taylorswift13', 'world', 'tour', 'movi', 'backseat', 'car', 'cri'], ['AppleMus', 'HERE'], ['TY', ' a', 'taylorswift13', '✨'], ['Watch', 'AppleMus'], [], [], ['TwitterMo', 'Peopl', 'World', 'Tour', 'Live', 'moment'], [' a', 'AppleMus'], ['clip', 'memori'], ['TheEllenShow', '✨✨✨'], [], ['Celebr', 'Decemb', ' a', 'AppleMus'], [], ['Met', ' a', 'ZaneLow', 'air', 'tomorrow', 'PST', ' a', 'Beats1'], [], ['Thank', 'birthday', 'surpris'], [' a', 'applemus'], [], ['Today', 'year', 'stuff'], ['Farewel', 'World', 'Tour', '❤️'], ['World', 'Tour', 'chapter', 'stori', 'Thank'], ['selfi', ' though'], ['Thank', 'Brisban', 'epic', 'night', 'guy', '❤️'], ['Me', 'Pleas'], ['Kangaroo', 'No'], ['friend', 'Hamilton', 'Island'], ['Swift', 'famili', 'road', 'trip'], ['South', 'Island', 'NZ'], [], [' a', 'austinswift7'], ['Sydney'], [], ['Pari', 'heart'], ['Farewel', 'Shanghai'], [], []]]
#
# user = tfidf_rank(ky, 2)
#
# print(user)
